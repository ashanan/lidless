<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Lidless Web</title>
</head>
<!--[if lte IE 8]><script language="javascript" type="text/javascript" src="/flot/excanvas.min.js"></script><![endif]-->
<script language="javascript" type="text/javascript" src="/flot/jquery.js"></script>
<script language="javascript" type="text/javascript" src="/flot/jquery.flot.js"></script>
</script>
<script type="text/javascript">

// ratio callback cycle; 1000ms live refresh
function start_callback() {
	$.ajax({
		url: '/api/camera1/ratio',
		dataType: 'json',
		success: function(data) {
			var mytext = Math.round(data.data * 100) + '%';
			$('div.ratio').html(mytext);
			setTimeout(start_callback, 1000);
		},
		failure: function(data) {
			alert("Call failed for some reason. Reload the page.");
		}
	});
}

function start_history() {
	$.ajax({
		url: '/api/camera1/history',
		dataType: 'json',
		success : function(data) {
			$.plot($("#camera1trace"), [data.data], {
				color: 'green',
				xaxis: { mode: "time" },
				yaxis: { min: 0 }
			});
			setTimeout(start_history, 1000 * 120);
		},
		failure: function(data) {
			alert("Call failed for some reason. Reload the page.");
		}
	});
}

$(function () {
	start_callback();
	start_history();
});     
    
</script>
<body style="height: 100%;">
<div style="text-align: center; font-size: 170pt; vertical-align: middle; width: 100%; height: 100%;" id="ratio" class="ratio">Checking..</div>
<br />
<div style="text-align: center; width: 100%;">
<div id="camera1trace" style="width:80%;height:150px;margin: auto;"></div>
<tt>Note: times are UTC.</tt>
</div>
</body>
</html>

